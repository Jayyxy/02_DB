



-- 테이블 생성 
CREATE TABLE "CATEGORIES2"(
		CATEGORY_ID  NUMBER PRIMARY KEY,
		CATEGORY_NAME VARCHAR2(100) UNIQUE

 );
 

 
CREATE TABLE "PRODUCTS2"(
	PRODUCT_ID NUMBER PRIMARY KEY ,
	PRODUCT_NAME VARCHAR2(100) NOT NULL,
	CATEGORY NUMBER ,
	PRICE NUMBER DEFAULT 0,
	STOCK_QUANTITY NUMBER DEFAULT 0,
	FOREIGN KEY () - CATEGORIES(CATEGORY_ID)],

		);
		
		
CREATE TABLE "COUSTOMERS2"(
	CUSTOMER_ID  NUMBER PRIMARY KEY,
 	NAME  VARCHAR2(20) NOT NULL,
	GENDER  CHAR(3) CHECK (남, 여),
	ADDRESS  VARCHAR2(100),
	PHONE  VARCHAR2(30),
);

CREATE TABLE "ORDERS2"(
	ORDER_ID NUMBER PRIMARY KEY,
	ORDER_DATE DATE DEFAULT SYSDATE,
	STATUS  CHAR(1) CHECK ('Y', 'N') DEFAULT 'N',
	CUSTOMER_ID NUMBER -- [FK - CUSTOMERS(CUSTOMER_ID) ON DELETE CASCADE

);

CREATE TABLE "ORDER_DETAILS2"(
ORDER_DETAIL_ID NUMBER PRIMARY KEY,
ORDER_ID NUMBER -- [FK - ORDERS(ORDER_ID) ON DELETE CASCADE],
PRODUCT_ID NUMBER -- [FK - PRODUCTS(PRODUCT_ID) ON DELETESET NULL],
QUANTITY NUMBER,
PRICE_PER_UNIT NUMBER,

);




-- 테이블 값 입력

INSERT INTO CATEGORIES2 VALUES (1,'스마트폰'); 
INSERT INTO CATEGORIES2 VALUES (2,'TV'); 
INSERT INTO CATEGORIES2 VALUES (3,'Gaming'); 

INSERT INTO PRODUCTS2 VALUES (101, 'Apple iPhone',1,1500000,30); 
INSERT INTO PRODUCTS2 VALUES (102, 'Samsung Galaxy S24',1,1800000,50); 
INSERT INTO PRODUCTS2 VALUES (201, 'LG OLED TV',2, 3600000,10); 
INSERT INTO PRODUCTS2 VALUES (301, 'Sony PlayStation5' ,3 ,700000,15); 


INSERT INTO CUSTOMERS2 VALUES (1, '홍길동' ,'남' ,'서울시 성동구 왕십리', '010-1111-2222'); 
INSERT INTO CUSTOMERS2 VALUES (2, '유관순' ,'여' ,'서울시 종로구 안국동', '010-3333-1111'); 

INSERT INTO ORDERS2 VALUES (576, '2024-02-29' ,'N' ,1); 
INSERT INTO ORDERS2 VALUES (978, '2024-03-11' ,'Y' ,2); 
INSERT INTO ORDERS2 VALUES (777, '2024-03-11' ,'N' ,2); 
INSERT INTO ORDERS2 VALUES (134, '2022-12-25 ','Y' ,1); 
INSERT INTO ORDERS2 VALUES (499, '2020-01-03 ','Y' ,1); 


INSERT INTO ORDER_DETAILS2 VALUES (111, 576, 101, 1 , 1500000);
INSERT INTO ORDER_DETAILS2 VALUES (222, 978, 201, 2 , 3600000);
INSERT INTO ORDER_DETAILS2 VALUES (333, 978, 102, 1 , 1800000);
INSERT INTO ORDER_DETAILS2 VALUES (444, 777, 301, 5 , 700000);
INSERT INTO ORDER_DETAILS2 VALUES (555, 134, 102, 1 , 1800000);
INSERT INTO ORDER_DETAILS2 VALUES (666, 499, 201, 3 , 3600000);


-- 테이블 조회 



-- 1번
SELECT NAME 고객명, ORDER_DATE 주문일, STATUS 처리상태
FROM ORDERS O
JOIN CUSTOMERS C ON(O.CUSTOMER_ID = C.CUSTOMER_ID )
WHERE STATUS = 'N'; 


-- 2번
SELECT ORDER_ID 주문번호, ORDER_DATE 주문날짜, STATUS 처리상태
FROM ORDERS O
JOIN CUSTOMERS C ON(O.CUSTOMER_ID = C.CUSTOMER_ID )
WHERE NAME = '홍길동'
AND EXTRACT(YEAR FROM ORDER_DATE) = 2024;


-- 3번
SELECT O.ORDER_ID 주문번호, P.PRODUCT_NAME 상품명, QUANTITY 수량, 
PRICE_PER_UNIT 개별금액, (QUANTITY * PRICE_PER_UNIT) 주문별금액합계
FROM ORDER_DETAILS OD
JOIN ORDERS O ON(OD.ORDER_ID = O.ORDER_ID)
JOIN CUSTOMERS C ON(O.CUSTOMER_ID = C.CUSTOMER_ID )
JOIN PRODUCTS P ON (OD.PRODUCT_ID = P.PRODUCT_ID)
WHERE NAME = '유관순'
ORDER BY 주문번호, 상품명;


